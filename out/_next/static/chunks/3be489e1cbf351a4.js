(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,31278,e=>{"use strict";let t=(0,e.i(75254).default)("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);e.s(["Loader2",()=>t],31278)},15057,e=>{"use strict";let t=(0,e.i(75254).default)("arrow-up-right",[["path",{d:"M7 7h10v10",key:"1tivn9"}],["path",{d:"M7 17 17 7",key:"1vkiza"}]]);e.s(["ArrowUpRight",()=>t],15057)},37346,e=>{"use strict";var t=e.i(43476),s=e.i(94690),a=e.i(83086),i=e.i(15057),r=e.i(78894),l=e.i(25652),n=e.i(37727),o=e.i(31278);let d=(0,e.i(75254).default)("zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]]);var c=e.i(81239),m=e.i(71645),h=e.i(7471),g=e.i(18566);function x(){let{activeStore:e}=(0,s.useAuth)(),{showToast:x}=(0,c.useToast)(),u=(0,g.useRouter)(),[p,b]=(0,m.useState)([]),[f,k]=(0,m.useState)(!0);(0,m.useEffect)(()=>{e?.id&&y()},[e]);let y=async()=>{if(e?.id){k(!0);try{let{data:t}=await h.supabase.from("products").select("*").eq("store_id",e.id),s=new Date;s.setDate(s.getDate()-30);let{data:a}=await h.supabase.from("sales").select("*, sale_items(product_name, quantity, total)").eq("store_id",e.id).gte("created_at",s.toISOString()).order("created_at",{ascending:!1}),{data:i}=await h.supabase.from("customers").select("*").eq("store_id",e.id),r=[];if(t){let e=t.filter(e=>e.stock<=0),s=t.filter(e=>e.stock>0&&e.stock<=5);e.length>0&&r.push({id:"stock-out",type:"alert",title:"Critical Stockouts Detected",message:`${e.length} products including "${e[0]?.name||"Unknown"}" are completely out of stock.`,impact:"Potential Lost Revenue",timestamp:"Real-time",read:!1,action:"Restock Now",link:"/dashboard/inventory"}),s.length>0&&r.push({id:"low-stock",type:"alert",title:"Low Inventory Warning",message:`${s.length} items are running low. "${s[0]?.name||"Unknown"}" has only ${s[0]?.stock} units left.`,impact:"High Priority",timestamp:"Real-time",read:!1,action:"View Inventory",link:"/dashboard/inventory"})}if(a&&a.length>0){let e=new Date,t=new Date(e.getTime()-6048e5),s=a.filter(e=>new Date(e.created_at)>t).reduce((e,t)=>e+t.total_amount,0);s>0&&r.push({id:"sales-trend",type:"opportunity",title:"Weekly Sales Performance",message:`You've generated GHS ${s.toFixed(2)} in revenue over the last 7 days. Keep up the momentum!`,impact:"Revenue Growth",timestamp:"1 hour ago",read:!0,action:"View History",link:"/dashboard/sales/history"});let i={};a.forEach(e=>{e.sale_items?.forEach(e=>{let t=e.product_name||"Unknown Item";i[t]=(i[t]||0)+(e.quantity||1)})});let l="",n=0;Object.entries(i).forEach(([e,t])=>{t>n&&(n=t,l=e)}),l&&r.push({id:"top-product",type:"insight",title:"Top Performing Product",message:`"${l}" is your best seller this month with ${n} units sold. Consider featuring it prominently.`,impact:"Maximize Profit",timestamp:"Recently",read:!1,action:"Create Promo"})}else r.push({id:"no-sales",type:"insight",title:"Awaiting Sales Data",message:"Start processing sales to unlock powerful AI revenue insights and trends.",impact:"Getting Started",timestamp:"Now",read:!0,action:"Go to POS",link:"/dashboard/sales"});i&&i.length>0&&r.push({id:"customer-base",type:"insight",title:"Customer Growth",message:`You have ${i.length} registered customers. Engaging them with loyalty rewards increases retention by 40%.`,impact:"Loyalty Boost",timestamp:"Today",read:!0,action:"Manage Customers",link:"/dashboard/customers"}),b(r)}catch(e){console.error("Error generating insights:",e),x("error","Failed to refresh AI insights")}finally{k(!1)}}},w=e=>{b(t=>t.filter(t=>t.id!==e))};return e?f?(0,t.jsx)("div",{className:"flex h-[50vh] items-center justify-center",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)(o.Loader2,{className:"h-8 w-8 animate-spin text-indigo-600 mx-auto"}),(0,t.jsx)("p",{className:"mt-4 text-slate-500",children:"Analyzing store data..."})]})}):(0,t.jsxs)("div",{className:"space-y-6 animate-in fade-in slide-in-from-bottom-4 duration-500",children:[(0,t.jsxs)("div",{className:"flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)("h1",{className:"text-2xl font-bold text-slate-900 dark:text-slate-100 flex items-center gap-2",children:[(0,t.jsx)(a.Sparkles,{className:"h-6 w-6 text-indigo-500"}),"AI Strategic Assistant"]}),(0,t.jsx)("p",{className:"text-sm text-slate-500 dark:text-slate-400",children:"Real-time alerts and actionable insights for your business."})]}),(0,t.jsxs)("button",{onClick:y,className:"flex items-center gap-2 px-3 py-1.5 text-sm font-medium text-indigo-600 bg-indigo-50 rounded-lg hover:bg-indigo-100 dark:bg-indigo-900/30 dark:text-indigo-400 dark:hover:bg-indigo-900/50 transition-colors",children:[(0,t.jsx)(d,{className:"h-4 w-4"}),"Refresh Analysis"]})]}),0===p.length?(0,t.jsxs)("div",{className:"text-center py-12 bg-white rounded-2xl border border-slate-200 dark:bg-slate-900 dark:border-slate-800",children:[(0,t.jsx)(a.Sparkles,{className:"h-12 w-12 text-slate-300 mx-auto mb-4"}),(0,t.jsx)("h3",{className:"text-lg font-medium text-slate-900 dark:text-white",children:"All Clear!"}),(0,t.jsx)("p",{className:"text-slate-500 dark:text-slate-400",children:"Your store is running smoothly. No critical alerts at this time."})]}):(0,t.jsx)("div",{className:"grid gap-6 max-w-4xl mx-auto",children:p.map(e=>(0,t.jsxs)("div",{className:`relative overflow-hidden rounded-2xl border bg-white p-6 shadow-sm transition-all hover:shadow-md dark:bg-slate-900 ${e.read?"border-slate-200 dark:border-slate-800":"border-indigo-200 dark:border-indigo-800 ring-1 ring-indigo-500/20"}`,children:[(0,t.jsx)("div",{className:`absolute left-0 top-0 h-full w-1 ${"opportunity"===e.type?"bg-emerald-500":"alert"===e.type?"bg-amber-500":"bg-indigo-500"}`}),(0,t.jsxs)("div",{className:"flex items-start justify-between gap-4",children:[(0,t.jsxs)("div",{className:"flex gap-4",children:[(0,t.jsx)("div",{className:`mt-1 flex h-10 w-10 flex-shrink-0 items-center justify-center rounded-full ${"opportunity"===e.type?"bg-emerald-100 text-emerald-600 dark:bg-emerald-900/30":"alert"===e.type?"bg-amber-100 text-amber-600 dark:bg-amber-900/30":"bg-indigo-100 text-indigo-600 dark:bg-indigo-900/30"}`,children:"opportunity"===e.type?(0,t.jsx)(l.TrendingUp,{className:"h-5 w-5"}):"alert"===e.type?(0,t.jsx)(r.AlertTriangle,{className:"h-5 w-5"}):(0,t.jsx)(a.Sparkles,{className:"h-5 w-5"})}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("h3",{className:"font-semibold text-slate-900 dark:text-white",children:e.title}),!e.read&&(0,t.jsx)("span",{className:"inline-flex items-center rounded-full bg-indigo-100 px-2 py-0.5 text-xs font-medium text-indigo-700 dark:bg-indigo-900/50 dark:text-indigo-400",children:"New"})]}),(0,t.jsx)("p",{className:"mt-1 text-slate-600 dark:text-slate-300",children:e.message}),(0,t.jsxs)("div",{className:"mt-3 flex items-center gap-4 text-sm",children:[(0,t.jsxs)("span",{className:"font-medium text-emerald-600 dark:text-emerald-400",children:["Impact: ",e.impact]}),(0,t.jsx)("span",{className:"text-slate-400",children:"â€¢"}),(0,t.jsx)("span",{className:"text-slate-500",children:e.timestamp})]})]})]}),(0,t.jsx)("button",{onClick:()=>w(e.id),className:"text-slate-400 transition-colors hover:text-slate-500 dark:hover:text-slate-300",children:(0,t.jsx)(n.X,{className:"h-5 w-5"})})]}),(0,t.jsxs)("div",{className:"mt-6 flex justify-end gap-3 border-t border-slate-100 pt-4 dark:border-slate-800",children:[(0,t.jsx)("button",{onClick:()=>w(e.id),className:"rounded-lg px-4 py-2 text-sm font-medium text-slate-600 transition-colors hover:bg-slate-50 dark:text-slate-400 dark:hover:bg-slate-800",children:"Dismiss"}),(0,t.jsxs)("button",{onClick:()=>{e.link?u.push(e.link):(x("success","Action initiated! System is optimizing..."),setTimeout(()=>w(e.id),1e3))},className:"flex items-center gap-2 rounded-lg bg-slate-900 px-4 py-2 text-sm font-medium text-white transition-colors hover:bg-slate-800 dark:bg-slate-100 dark:text-slate-900 dark:hover:bg-slate-200",children:[e.action||"Take Action",(0,t.jsx)(i.ArrowUpRight,{className:"h-4 w-4"})]})]})]},e.id))})]}):null}e.s(["default",()=>x],37346)}]);