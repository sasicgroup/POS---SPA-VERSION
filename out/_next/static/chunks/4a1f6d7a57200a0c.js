(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,7233,e=>{"use strict";let t=(0,e.i(75254).default)("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);e.s(["Plus",()=>t],7233)},55436,e=>{"use strict";let t=(0,e.i(75254).default)("search",[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]]);e.s(["Search",()=>t],55436)},27612,e=>{"use strict";let t=(0,e.i(75254).default)("trash-2",[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]]);e.s(["Trash2",()=>t],27612)},56909,e=>{"use strict";let t=(0,e.i(75254).default)("save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]);e.s(["Save",()=>t],56909)},31278,e=>{"use strict";let t=(0,e.i(75254).default)("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);e.s(["Loader2",()=>t],31278)},87316,e=>{"use strict";let t=(0,e.i(75254).default)("calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);e.s(["Calendar",()=>t],87316)},37453,e=>{"use strict";var t=e.i(43476),s=e.i(94690),a=e.i(42009),r=e.i(39616),l=e.i(61911),i=e.i(75254);let d=(0,i.default)("gift",[["rect",{x:"3",y:"8",width:"18",height:"4",rx:"1",key:"bkv52"}],["path",{d:"M12 8v13",key:"1c76mn"}],["path",{d:"M19 12v7a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2v-7",key:"6wjy6b"}],["path",{d:"M7.5 8a2.5 2.5 0 0 1 0-5A4.8 8 0 0 1 12 8a4.8 8 0 0 1 4.5-5 2.5 2.5 0 0 1 0 5",key:"1ihvrl"}]]);var n=e.i(25652),o=e.i(7233),c=e.i(56909),m=e.i(27612),x=e.i(37727),h=e.i(87316);let b=(0,i.default)("megaphone",[["path",{d:"M11 6a13 13 0 0 0 8.4-2.8A1 1 0 0 1 21 4v12a1 1 0 0 1-1.6.8A13 13 0 0 0 11 14H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2z",key:"q8bfy3"}],["path",{d:"M6 14a12 12 0 0 0 2.4 7.2 2 2 0 0 0 3.2-2.4A8 8 0 0 1 10 14",key:"1853fq"}],["path",{d:"M8 6v8",key:"15ugcq"}]]);var p=e.i(55436),u=e.i(63209),g=e.i(69638),f=e.i(31278);let j=(0,i.default)("history",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]]);var v=e.i(7471),k=e.i(71645),y=e.i(81239);function N(){let{activeStore:e}=(0,s.useAuth)(),[i,N]=(0,k.useState)("overview"),[w,C]=(0,k.useState)(""),[S,_]=(0,k.useState)(!1),[P,M]=(0,k.useState)(null),[D,R]=(0,k.useState)(""),[T,$]=(0,k.useState)(""),[q,A]=(0,k.useState)(""),[E,L]=(0,k.useState)(""),I=async()=>{if(e?.id&&w){_(!0),M(null),A(""),L("");try{let{data:t,error:s}=await v.supabase.from("customers").select("*").eq("store_id",e.id).eq("phone",w).single();t?M(t):L("Customer not found")}catch(e){console.error(e),L("Error fetching customer")}finally{_(!1)}}},B=async()=>{if(!e||!P||!D)return;let t=parseInt(D);if(isNaN(t)||t<=0)return void L("Invalid points amount");if(P.points<G.minRedemptionPoints)return void L(`Customer must have at least ${G.minRedemptionPoints} points to redeem.`);if(t>(P.points||0))return void L("Insufficient points balance");_(!0);try{let s=(P.points||0)-t,{error:a}=await v.supabase.from("customers").update({points:s}).eq("id",P.id);if(a)throw a;await v.supabase.from("loyalty_logs").insert({store_id:e.id,customer_id:P.id,points:-t,type:"redeemed",description:T||"Redemption"}),A(`Successfully redeemed ${t} points for ${P.name}. New Balance: ${s}`),M({...P,points:s}),R(""),$("")}catch(e){console.error(e),L("Redemption failed")}finally{_(!1)}},[H,z]=(0,k.useState)({totalMembers:0,pointsIssued:0,pointsRedeemed:0,activeRate:"0%"}),[G,F]=(0,k.useState)({enabled:!0,pointsPerCurrency:1,redemptionRate:.05,minRedemptionPoints:100,expiryMonths:12}),[V,O]=(0,k.useState)(!1),{showToast:U}=(0,y.useToast)();(0,k.useEffect)(()=>{(async()=>{if(!e?.id)return;let{data:t,error:s}=await v.supabase.from("loyalty_programs").select("*").eq("store_id",e.id).single();t?F({enabled:t.enabled,pointsPerCurrency:t.points_per_currency,redemptionRate:t.redemption_rate,minRedemptionPoints:t.min_points_to_redeem,expiryMonths:12}):t||s||await v.supabase.from("loyalty_programs").insert({store_id:e.id,points_per_currency:.01,redemption_rate:.01,min_points_to_redeem:100});let{data:a}=await v.supabase.from("loyalty_tiers").select("*").eq("store_id",e.id).order("min_points",{ascending:!0});if(a&&a.length>0)Q(a.map(e=>({id:e.id,name:e.name,minPoints:e.min_points,benefits:e.benefits||[]})));else{for(let t of[{name:"Bronze",min_points:0,benefits:["Earn 1x Points"]},{name:"Silver",min_points:1e3,benefits:["Earn 1.2x Points","Birthday Gift"]},{name:"Gold",min_points:5e3,benefits:["Earn 1.5x Points","Free Delivery","Priority Support"]}])await v.supabase.from("loyalty_tiers").insert({store_id:e.id,...t});let{data:t}=await v.supabase.from("loyalty_tiers").select("*").eq("store_id",e.id).order("min_points",{ascending:!0});t&&Q(t.map(e=>({id:e.id,name:e.name,minPoints:e.min_points,benefits:e.benefits||[]})))}let{count:r}=await v.supabase.from("customers").select("*",{count:"exact",head:!0}).eq("store_id",e.id),{data:l}=await v.supabase.from("loyalty_logs").select("*, customer:customers(name)").eq("store_id",e.id),i=0,d=0;l&&l.forEach(e=>{"earned"===e.type&&(i+=e.points),"redeemed"===e.type&&(d+=Math.abs(e.points))}),z({totalMembers:r||0,pointsIssued:i,pointsRedeemed:d,activeRate:"0%"}),l&&X(l.sort((e,t)=>new Date(t.created_at).getTime()-new Date(e.created_at).getTime()))})()},[e]);let[K,X]=(0,k.useState)([]),Y=async()=>{if(!e?.id)return;O(!0);let{error:t}=await v.supabase.from("loyalty_programs").upsert({store_id:e.id,points_per_currency:G.pointsPerCurrency,redemption_rate:G.redemptionRate,min_points_to_redeem:G.minRedemptionPoints,enabled:G.enabled},{onConflict:"store_id"});t?(console.error("Failed to save settings:",t),U("error","Failed to save loyalty settings")):U("success","Loyalty settings saved!"),O(!1)},[J,Q]=(0,k.useState)([]),[W,Z]=(0,k.useState)(!1),[ee,et]=(0,k.useState)(null),[es,ea]=(0,k.useState)(!1),[er,el]=(0,k.useState)([]),[ei,ed]=(0,k.useState)(!1);return e?(0,t.jsxs)("div",{className:"space-y-6 animate-in fade-in slide-in-from-bottom-4 duration-500",children:[(0,t.jsx)("div",{className:"flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between",children:(0,t.jsxs)("div",{children:[(0,t.jsxs)("h1",{className:"text-2xl font-bold text-slate-900 dark:text-slate-100 flex items-center gap-2",children:[(0,t.jsx)(a.Award,{className:"h-6 w-6 text-indigo-500"}),"Loyalty & Rewards"]}),(0,t.jsx)("p",{className:"text-sm text-slate-500 dark:text-slate-400",children:"Manage customer retention and point systems."})]})}),(0,t.jsx)("div",{className:"border-b border-slate-200 dark:border-slate-800",children:(0,t.jsxs)("nav",{className:"-mb-px flex space-x-8","aria-label":"Tabs",children:[(0,t.jsxs)("button",{onClick:()=>N("overview"),className:`group flex items-center border-b-2 py-4 px-1 text-sm font-medium
                                ${"overview"===i?"border-indigo-500 text-indigo-600 dark:text-indigo-400":"border-transparent text-slate-500 hover:border-slate-300 hover:text-slate-700 dark:text-slate-400 dark:hover:text-slate-300"}
                            `,children:[(0,t.jsx)(n.TrendingUp,{className:`mr-2 h-5 w-5 ${"overview"===i?"text-indigo-500":"text-slate-400 group-hover:text-slate-500"}`}),"Overview"]}),(0,t.jsxs)("button",{onClick:()=>N("redemption"),className:`group flex items-center border-b-2 py-4 px-1 text-sm font-medium
                                ${"redemption"===i?"border-indigo-500 text-indigo-600 dark:text-indigo-400":"border-transparent text-slate-500 hover:border-slate-300 hover:text-slate-700 dark:text-slate-400 dark:hover:text-slate-300"}
                            `,children:[(0,t.jsx)(d,{className:`mr-2 h-5 w-5 ${"redemption"===i?"text-indigo-500":"text-slate-400 group-hover:text-slate-500"}`}),"Redeem Points"]}),(0,t.jsxs)("button",{onClick:()=>N("history"),className:`group flex items-center border-b-2 py-4 px-1 text-sm font-medium
                                ${"history"===i?"border-indigo-500 text-indigo-600 dark:text-indigo-400":"border-transparent text-slate-500 hover:border-slate-300 hover:text-slate-700 dark:text-slate-400 dark:hover:text-slate-300"}
                            `,children:[(0,t.jsx)(j,{className:`mr-2 h-5 w-5 ${"history"===i?"text-indigo-500":"text-slate-400 group-hover:text-slate-500"}`}),"History"]}),(0,t.jsxs)("button",{onClick:()=>N("settings"),className:`group flex items-center border-b-2 py-4 px-1 text-sm font-medium
                                ${"settings"===i?"border-indigo-500 text-indigo-600 dark:text-indigo-400":"border-transparent text-slate-500 hover:border-slate-300 hover:text-slate-700 dark:text-slate-400 dark:hover:text-slate-300"}
                            `,children:[(0,t.jsx)(r.Settings,{className:`mr-2 h-5 w-5 ${"settings"===i?"text-indigo-500":"text-slate-400 group-hover:text-slate-500"}`}),"Program Settings"]}),(0,t.jsxs)("button",{onClick:()=>N("tiers"),className:`group flex items-center border-b-2 py-4 px-1 text-sm font-medium
                                ${"tiers"===i?"border-indigo-500 text-indigo-600 dark:text-indigo-400":"border-transparent text-slate-500 hover:border-slate-300 hover:text-slate-700 dark:text-slate-400 dark:hover:text-slate-300"}
                            `,children:[(0,t.jsx)(l.Users,{className:`mr-2 h-5 w-5 ${"tiers"===i?"text-indigo-500":"text-slate-400 group-hover:text-slate-500"}`}),"Tiers & Benefits"]})]})}),"overview"===i&&(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"grid gap-4 sm:grid-cols-2 lg:grid-cols-4",children:[(0,t.jsxs)("div",{className:"rounded-xl border border-slate-200 bg-white p-6 shadow-sm dark:border-slate-800 dark:bg-slate-900",children:[(0,t.jsx)("p",{className:"text-sm font-medium text-slate-500",children:"Total Members"}),(0,t.jsx)("h3",{className:"text-2xl font-bold text-slate-900 dark:text-white",children:H.totalMembers.toLocaleString()})]}),(0,t.jsxs)("div",{className:"rounded-xl border border-slate-200 bg-white p-6 shadow-sm dark:border-slate-800 dark:bg-slate-900",children:[(0,t.jsx)("p",{className:"text-sm font-medium text-slate-500",children:"Total Points Issued"}),(0,t.jsx)("h3",{className:"text-2xl font-bold text-indigo-600",children:H.pointsIssued.toLocaleString()})]}),(0,t.jsxs)("div",{className:"rounded-xl border border-slate-200 bg-white p-6 shadow-sm dark:border-slate-800 dark:bg-slate-900",children:[(0,t.jsx)("p",{className:"text-sm font-medium text-slate-500",children:"Points Redeemed"}),(0,t.jsx)("h3",{className:"text-2xl font-bold text-slate-900 dark:text-white",children:H.pointsRedeemed.toLocaleString()})]}),(0,t.jsxs)("div",{className:"rounded-xl border border-slate-200 bg-white p-6 shadow-sm dark:border-slate-800 dark:bg-slate-900",children:[(0,t.jsx)("p",{className:"text-sm font-medium text-slate-500",children:"Active Participation"}),(0,t.jsx)("h3",{className:"text-2xl font-bold text-emerald-600",children:H.activeRate})]})]}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)("h2",{className:"text-lg font-semibold text-slate-900 dark:text-white",children:"Active Campaigns"}),er.length>0&&(0,t.jsxs)("button",{onClick:()=>ed(!0),className:"inline-flex items-center rounded-md bg-indigo-600 px-3 py-2 text-sm font-semibold text-white shadow-sm hover:bg-indigo-500",children:[(0,t.jsx)(o.Plus,{className:"-ml-0.5 mr-1.5 h-5 w-5","aria-hidden":"true"}),"New Campaign"]})]}),0===er.length?(0,t.jsxs)("div",{className:"rounded-xl border border-slate-200 bg-white p-8 text-center dark:border-slate-800 dark:bg-slate-900",children:[(0,t.jsx)(d,{className:"mx-auto h-12 w-12 text-slate-400"}),(0,t.jsx)("h3",{className:"mt-2 text-sm font-semibold text-slate-900 dark:text-white",children:"No active campaigns"}),(0,t.jsx)("p",{className:"mt-1 text-sm text-slate-500",children:"Get started by creating a double-points weekend promo."}),(0,t.jsx)("div",{className:"mt-6",children:(0,t.jsxs)("button",{onClick:()=>ed(!0),className:"inline-flex items-center rounded-md bg-indigo-600 px-3 py-2 text-sm font-semibold text-white shadow-sm hover:bg-indigo-500",children:[(0,t.jsx)(o.Plus,{className:"-ml-0.5 mr-1.5 h-5 w-5","aria-hidden":"true"}),"Create Campaign"]})})]}):(0,t.jsx)("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:er.map(e=>(0,t.jsxs)("div",{className:"relative rounded-xl border border-slate-200 bg-white p-6 shadow-sm dark:border-slate-800 dark:bg-slate-900",children:[(0,t.jsxs)("div",{className:"flex items-start justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("div",{className:"rounded-lg bg-indigo-100 p-2 text-indigo-600 dark:bg-indigo-900/30 dark:text-indigo-400",children:(0,t.jsx)(b,{className:"h-5 w-5"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"font-semibold text-slate-900 dark:text-white",children:e.name}),(0,t.jsx)("p",{className:"text-xs text-slate-500 line-clamp-1",children:e.description})]})]}),(0,t.jsx)("span",{className:`inline-flex items-center rounded-full px-2 py-1 text-xs font-medium ${new Date(e.endDate)<new Date?"bg-slate-100 text-slate-700 dark:bg-slate-800 dark:text-slate-300":"bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-400"}`,children:new Date(e.endDate)<new Date?"Ended":"Active"})]}),(0,t.jsxs)("div",{className:"mt-4 flex items-center justify-between text-sm text-slate-500",children:[(0,t.jsxs)("div",{className:"flex items-center gap-1",children:[(0,t.jsx)(h.Calendar,{className:"h-4 w-4"}),(0,t.jsxs)("span",{children:[new Date(e.startDate).toLocaleDateString()," - ",new Date(e.endDate).toLocaleDateString()]})]}),(0,t.jsx)("button",{onClick:()=>el(er.filter(t=>t.id!==e.id)),className:"text-slate-400 hover:text-red-500",children:(0,t.jsx)(m.Trash2,{className:"h-4 w-4"})})]})]},e.id))})]})]}),"history"===i&&(0,t.jsx)("div",{className:"space-y-6",children:(0,t.jsxs)("div",{className:"rounded-xl border border-slate-200 bg-white shadow-sm dark:border-slate-800 dark:bg-slate-900 overflow-hidden",children:[(0,t.jsx)("div",{className:"border-b border-slate-200 bg-slate-50 px-6 py-4 dark:border-slate-800 dark:bg-slate-800/50",children:(0,t.jsx)("h3",{className:"font-semibold text-slate-900 dark:text-slate-100",children:"Loyalty Transactions"})}),0===K.length?(0,t.jsx)("div",{className:"p-10 text-center text-slate-500",children:"No loyalty transactions found."}):(0,t.jsx)("div",{className:"overflow-x-auto",children:(0,t.jsxs)("table",{className:"w-full text-left text-sm",children:[(0,t.jsx)("thead",{className:"bg-slate-50 dark:bg-slate-800/50",children:(0,t.jsxs)("tr",{children:[(0,t.jsx)("th",{className:"px-6 py-3 font-medium text-slate-500",children:"Date"}),(0,t.jsx)("th",{className:"px-6 py-3 font-medium text-slate-500",children:"Customer"}),(0,t.jsx)("th",{className:"px-6 py-3 font-medium text-slate-500",children:"Type"}),(0,t.jsx)("th",{className:"px-6 py-3 font-medium text-slate-500",children:"Points"}),(0,t.jsx)("th",{className:"px-6 py-3 font-medium text-slate-500",children:"Description"})]})}),(0,t.jsx)("tbody",{className:"divide-y divide-slate-100 dark:divide-slate-800",children:K.map(e=>(0,t.jsxs)("tr",{className:"hover:bg-slate-50 dark:hover:bg-slate-800/50",children:[(0,t.jsxs)("td",{className:"px-6 py-3 text-slate-900 dark:text-slate-200",children:[new Date(e.created_at).toLocaleDateString()," ",(0,t.jsx)("span",{className:"text-slate-400 text-xs",children:new Date(e.created_at).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]}),(0,t.jsx)("td",{className:"px-6 py-3 text-slate-600 dark:text-slate-400",children:e.customer?.name||"Unknown"}),(0,t.jsx)("td",{className:"px-6 py-3",children:(0,t.jsx)("span",{className:`px-2 py-1 rounded-full text-xs font-bold uppercase ${"earned"===e.type?"bg-green-100 text-green-700":"redeemed"===e.type?"bg-pink-100 text-pink-700":"bg-slate-100 text-slate-700"}`,children:e.type})}),(0,t.jsx)("td",{className:"px-6 py-3",children:(0,t.jsxs)("span",{className:`font-bold ${e.points>0?"text-green-600":"text-pink-600"}`,children:[e.points>0?"+":"",e.points]})}),(0,t.jsx)("td",{className:"px-6 py-3 text-slate-600 dark:text-slate-400",children:e.description})]},e.id))})]})})]})}),"redemption"===i&&(0,t.jsxs)("div",{className:"grid gap-6 md:grid-cols-2",children:[(0,t.jsxs)("div",{className:"bg-white dark:bg-slate-900 p-6 rounded-xl border border-slate-200 dark:border-slate-800 shadow-sm h-fit",children:[(0,t.jsx)("h2",{className:"text-lg font-semibold mb-4 text-slate-900 dark:text-white",children:"Find Customer"}),(0,t.jsxs)("div",{className:"flex gap-2 mb-4",children:[(0,t.jsxs)("div",{className:"relative flex-1",children:[(0,t.jsx)(p.Search,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-slate-400"}),(0,t.jsx)("input",{type:"tel",placeholder:"Enter phone number",className:"w-full pl-9 pr-4 py-2 rounded-lg border border-slate-200 dark:border-slate-700 bg-slate-50 dark:bg-slate-800 focus:outline-none focus:ring-2 focus:ring-indigo-500 text-sm",value:w,onChange:e=>C(e.target.value),onKeyDown:e=>"Enter"===e.key&&I()})]}),(0,t.jsx)("button",{onClick:I,disabled:S,className:"px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 disabled:opacity-50 text-sm font-medium",children:S?(0,t.jsx)(f.Loader2,{className:"h-4 w-4 animate-spin"}):"Search"})]}),E&&(0,t.jsxs)("div",{className:"p-3 bg-red-50 text-red-600 rounded-lg text-sm flex items-center gap-2 animate-in fade-in",children:[(0,t.jsx)(u.AlertCircle,{className:"h-4 w-4"}),E]}),q&&(0,t.jsxs)("div",{className:"p-3 bg-green-50 text-green-600 rounded-lg text-sm flex items-center gap-2 animate-in fade-in",children:[(0,t.jsx)(g.CheckCircle,{className:"h-4 w-4"}),q]})]}),(0,t.jsxs)("div",{className:"bg-white dark:bg-slate-900 p-6 rounded-xl border border-slate-200 dark:border-slate-800 shadow-sm relative overflow-hidden h-fit",children:[P?null:(0,t.jsx)("div",{className:"absolute inset-0 flex items-center justify-center bg-slate-50/50 dark:bg-slate-900/50 backdrop-blur-sm z-10 transition-all",children:(0,t.jsx)("p",{className:"text-slate-400 text-sm font-medium",children:"Search for a customer to redeem points"})}),(0,t.jsxs)("div",{className:"mb-6",children:[(0,t.jsx)("h2",{className:"text-xl font-bold text-slate-900 dark:text-white",children:P?.name}),(0,t.jsx)("p",{className:"text-slate-500 text-sm",children:P?.phone}),(0,t.jsxs)("div",{className:"mt-4 p-4 bg-indigo-50 dark:bg-indigo-900/20 rounded-lg border border-indigo-100 dark:border-indigo-900/50 flex justify-between items-center",children:[(0,t.jsx)("span",{className:"text-indigo-700 dark:text-indigo-300 font-medium text-sm",children:"Available Balance"}),(0,t.jsxs)("span",{className:"text-2xl font-bold text-indigo-600 dark:text-indigo-400",children:[P?.points||0," pts"]})]})]}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1",children:"Points to Redeem"}),(0,t.jsx)("input",{type:"number",className:"w-full px-3 py-2 rounded-lg border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800 focus:outline-none focus:ring-2 focus:ring-indigo-500 text-sm",placeholder:"0",value:D,onChange:e=>R(e.target.value)})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1",children:"Reason / Item Redeemed"}),(0,t.jsx)("input",{type:"text",className:"w-full px-3 py-2 rounded-lg border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800 focus:outline-none focus:ring-2 focus:ring-indigo-500 text-sm",placeholder:"e.g. T-Shirt, 10% Discount",value:T,onChange:e=>$(e.target.value)})]}),(0,t.jsx)("button",{onClick:B,disabled:S||!D,className:"w-full py-3 bg-pink-600 hover:bg-pink-700 text-white font-bold rounded-xl shadow-lg shadow-pink-500/30 transition-all disabled:opacity-50 disabled:shadow-none text-sm",children:"Redeem Points"})]})]})]}),"settings"===i&&(0,t.jsx)("div",{className:"max-w-2xl space-y-6",children:(0,t.jsxs)("div",{className:"rounded-xl border border-slate-200 bg-white p-6 shadow-sm dark:border-slate-800 dark:bg-slate-900 space-y-6",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"text-lg font-medium text-slate-900 dark:text-white",children:"Program Status"}),(0,t.jsx)("p",{className:"text-sm text-slate-500",children:"Enable or disable loyalty point accumulation."})]}),(0,t.jsxs)("label",{className:"relative inline-flex items-center cursor-pointer",children:[(0,t.jsx)("input",{type:"checkbox",checked:G.enabled,onChange:e=>F({...G,enabled:e.target.checked}),className:"sr-only peer"}),(0,t.jsx)("div",{className:"w-11 h-6 bg-slate-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-indigo-300 dark:peer-focus:ring-indigo-800 rounded-full peer dark:bg-slate-700 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-indigo-600"})]})]}),(0,t.jsx)("hr",{className:"border-slate-200 dark:border-slate-700"}),(0,t.jsxs)("div",{className:"grid gap-6 sm:grid-cols-2",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300",children:"Earn Rate"}),(0,t.jsxs)("div",{className:"mt-1 relative rounded-md shadow-sm",children:[(0,t.jsx)("input",{type:"number",value:G.pointsPerCurrency,onChange:e=>F({...G,pointsPerCurrency:parseFloat(e.target.value)}),className:"block w-full rounded-md border-slate-300 pl-3 pr-12 focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm dark:bg-slate-800 dark:border-slate-700 py-2 border"}),(0,t.jsx)("div",{className:"pointer-events-none absolute inset-y-0 right-0 flex items-center pr-3",children:(0,t.jsx)("span",{className:"text-slate-500 sm:text-sm",children:"Pts / GHS"})})]}),(0,t.jsxs)("p",{className:"mt-1 text-xs text-slate-500",children:["Customer earns ",G.pointsPerCurrency," point for every 1 GHS spent."]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300",children:"Min. Points to Redeem"}),(0,t.jsxs)("div",{className:"mt-1 relative rounded-md shadow-sm",children:[(0,t.jsx)("input",{type:"number",value:G.minRedemptionPoints,onChange:e=>F({...G,minRedemptionPoints:parseInt(e.target.value)||0}),className:"block w-full rounded-md border-slate-300 pl-3 pr-12 focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm dark:bg-slate-800 dark:border-slate-700 py-2 border"}),(0,t.jsx)("div",{className:"pointer-events-none absolute inset-y-0 right-0 flex items-center pr-3",children:(0,t.jsx)("span",{className:"text-slate-500 sm:text-sm",children:"Pts"})})]}),(0,t.jsx)("p",{className:"mt-1 text-xs text-slate-500",children:"Minimum balance required to start redeeming."})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300",children:"Redemption Value"}),(0,t.jsxs)("div",{className:"mt-1 relative rounded-md shadow-sm",children:[(0,t.jsx)("input",{type:"number",value:G.redemptionRate?Math.round(1/G.redemptionRate):"",onChange:e=>{let t=parseFloat(e.target.value);F({...G,redemptionRate:t?1/t:0})},className:"block w-full rounded-md border-slate-300 pl-3 pr-12 focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm dark:bg-slate-800 dark:border-slate-700 py-2 border"}),(0,t.jsx)("div",{className:"pointer-events-none absolute inset-y-0 right-0 flex items-center pr-3",children:(0,t.jsx)("span",{className:"text-slate-500 sm:text-sm",children:"Pts = 1 GHS"})})]}),(0,t.jsxs)("p",{className:"mt-1 text-xs text-slate-500",children:["Customer needs ",Math.round(1/G.redemptionRate)," points to get 1 GHS discount."]})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300",children:"Expiry"}),(0,t.jsxs)("select",{value:G.expiryMonths,onChange:e=>F({...G,expiryMonths:parseInt(e.target.value)}),className:"mt-1 block w-full rounded-md border-slate-300 py-2 pl-3 pr-10 text-base focus:border-indigo-500 focus:outline-none focus:ring-indigo-500 sm:text-sm dark:bg-slate-800 dark:border-slate-700 border",children:[(0,t.jsx)("option",{value:6,children:"6 Months"}),(0,t.jsx)("option",{value:12,children:"12 Months (1 Year)"}),(0,t.jsx)("option",{value:24,children:"24 Months (2 Years)"}),(0,t.jsx)("option",{value:0,children:"Never Expire"})]})]}),(0,t.jsx)("div",{className:"flex justify-end pt-4",children:(0,t.jsxs)("button",{onClick:Y,disabled:V,className:"flex items-center justify-center rounded-lg bg-indigo-600 px-4 py-2 text-sm font-medium text-white shadow-sm hover:bg-indigo-700 disabled:opacity-50 disabled:cursor-not-allowed",children:[(0,t.jsx)(c.Save,{className:"mr-2 h-4 w-4"}),V?"Saving...":"Save Settings"]})})]})}),"tiers"===i&&(0,t.jsx)("div",{className:"space-y-6",children:(0,t.jsxs)("div",{className:"grid gap-6 md:grid-cols-3",children:[J.map(e=>(0,t.jsxs)("div",{className:`rounded-xl border bg-white p-6 shadow-sm dark:bg-slate-900 ${"Gold"===e.name?"border-amber-200 ring-1 ring-amber-500/20 dark:border-amber-900":"Silver"===e.name?"border-slate-300 dark:border-slate-700":"border-orange-200 dark:border-orange-900"}`,children:[(0,t.jsxs)("div",{className:"flex justify-between items-start mb-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:`text-lg font-bold ${"Gold"===e.name?"text-amber-600":"Silver"===e.name?"text-slate-600 dark:text-slate-300":"text-orange-700"}`,children:e.name}),(0,t.jsxs)("p",{className:"text-xs text-slate-500",children:["Min. ",e.minPoints.toLocaleString()," Points"]})]}),(0,t.jsx)("button",{className:"text-slate-400 hover:text-slate-600",children:(0,t.jsx)(r.Settings,{className:"h-4 w-4"})})]}),(0,t.jsx)("ul",{className:"space-y-2 mb-6",children:e.benefits.map((e,s)=>(0,t.jsxs)("li",{className:"flex items-center text-sm text-slate-600 dark:text-slate-400",children:[(0,t.jsx)("div",{className:"mr-2 h-1.5 w-1.5 rounded-full bg-indigo-500"}),e]},s))}),(0,t.jsx)("button",{onClick:()=>{et(e),Z(!0)},className:"w-full rounded-lg border border-slate-200 bg-slate-50 px-4 py-2 text-sm font-medium text-slate-700 hover:bg-slate-100 dark:border-slate-700 dark:bg-slate-800 dark:text-slate-300 dark:hover:bg-slate-700",children:"Edit Benefits"})]},e.id)),(0,t.jsxs)("button",{className:"flex h-full min-h-[200px] flex-col items-center justify-center rounded-xl border-2 border-dashed border-slate-300 bg-slate-50 p-6 hover:border-indigo-500 hover:bg-slate-100 dark:border-slate-700 dark:bg-slate-800/50 dark:hover:border-indigo-500",children:[(0,t.jsx)("div",{className:"rounded-full bg-white p-3 dark:bg-slate-800",children:(0,t.jsx)(o.Plus,{className:"h-6 w-6 text-slate-400"})}),(0,t.jsx)("span",{className:"mt-3 text-sm font-medium text-slate-600 dark:text-slate-400",children:"Add New Tier"})]})]})}),W&&ee&&(0,t.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 backdrop-blur-sm animate-in fade-in",children:(0,t.jsxs)("div",{className:"w-full max-w-md rounded-2xl bg-white p-6 shadow-2xl dark:bg-slate-900 animate-in zoom-in-95",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,t.jsxs)("h2",{className:"text-xl font-bold text-slate-900 dark:text-white",children:["Edit ",ee.name," Tier"]}),(0,t.jsx)("button",{onClick:()=>Z(!1),className:"rounded-full p-2 hover:bg-slate-100 dark:hover:bg-slate-800",children:(0,t.jsx)(x.X,{className:"h-5 w-5 text-slate-500"})})]}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300",children:"Tier Name"}),(0,t.jsx)("input",{type:"text",value:ee.name,onChange:e=>et({...ee,name:e.target.value}),className:"mt-1 w-full rounded-lg border border-slate-200 bg-slate-50 px-3 py-2 text-sm outline-none focus:border-indigo-500 focus:ring-1 focus:ring-indigo-500 dark:border-slate-800 dark:bg-slate-800 dark:text-white"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300",children:"Minimum Points"}),(0,t.jsx)("input",{type:"number",value:ee.minPoints,onChange:e=>et({...ee,minPoints:parseInt(e.target.value)||0}),className:"mt-1 w-full rounded-lg border border-slate-200 bg-slate-50 px-3 py-2 text-sm outline-none focus:border-indigo-500 focus:ring-1 focus:ring-indigo-500 dark:border-slate-800 dark:bg-slate-800 dark:text-white"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2",children:"Benefits"}),(0,t.jsxs)("div",{className:"space-y-2",children:[ee.benefits.map((e,s)=>(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)("input",{type:"text",value:e,onChange:e=>{let t=[...ee.benefits];t[s]=e.target.value,et({...ee,benefits:t})},className:"flex-1 rounded-lg border border-slate-200 bg-slate-50 px-3 py-2 text-sm outline-none focus:border-indigo-500 dark:border-slate-800 dark:bg-slate-800 dark:text-white"}),(0,t.jsx)("button",{onClick:()=>{let e=ee.benefits.filter((e,t)=>t!==s);et({...ee,benefits:e})},className:"p-2 text-red-500 hover:bg-red-50 rounded-lg dark:hover:bg-red-900/30",children:(0,t.jsx)(m.Trash2,{className:"h-4 w-4"})})]},s)),(0,t.jsxs)("button",{onClick:()=>et({...ee,benefits:[...ee.benefits,""]}),className:"flex items-center gap-2 text-sm text-indigo-600 hover:text-indigo-700 font-medium mt-2",children:[(0,t.jsx)(o.Plus,{className:"h-4 w-4"})," Add Benefit"]})]})]})]}),(0,t.jsxs)("div",{className:"mt-8 flex gap-3",children:[(0,t.jsx)("button",{disabled:es,onClick:async()=>{ea(!0);try{let{error:e}=await v.supabase.from("loyalty_tiers").update({name:ee.name,min_points:ee.minPoints,benefits:ee.benefits}).eq("id",ee.id);if(e)throw e;Q(J.map(e=>e.id===ee.id?ee:e)),Z(!1),U("success","Tier benefits updated!")}catch(e){console.error(e),U("error","Failed to update tier")}finally{ea(!1)}},className:"flex-1 rounded-lg bg-indigo-600 py-2.5 text-sm font-medium text-white hover:bg-indigo-700 disabled:opacity-50",children:es?"Saving...":"Save Changes"}),(0,t.jsx)("button",{onClick:()=>Z(!1),className:"flex-1 rounded-lg border border-slate-200 py-2.5 text-sm font-medium text-slate-700 hover:bg-slate-50 dark:border-slate-700 dark:text-slate-300 dark:hover:bg-slate-800",children:"Cancel"})]})]})}),ei&&(0,t.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 backdrop-blur-sm animate-in fade-in",children:(0,t.jsxs)("div",{className:"w-full max-w-md rounded-2xl bg-white p-6 shadow-2xl dark:bg-slate-900 animate-in zoom-in-95",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,t.jsx)("h2",{className:"text-xl font-bold text-slate-900 dark:text-white",children:"Create New Campaign"}),(0,t.jsx)("button",{onClick:()=>ed(!1),className:"rounded-full p-2 hover:bg-slate-100 dark:hover:bg-slate-800",children:(0,t.jsx)(x.X,{className:"h-5 w-5 text-slate-500"})})]}),(0,t.jsxs)("form",{onSubmit:e=>{e.preventDefault();let t=new FormData(e.currentTarget);el([...er,{id:Date.now().toString(),name:t.get("name"),description:t.get("description"),startDate:t.get("startDate"),endDate:t.get("endDate"),createdAt:new Date().toISOString()}]),ed(!1)},children:[(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300",children:"Campaign Name"}),(0,t.jsx)("input",{name:"name",type:"text",required:!0,placeholder:"e.g. Summer Sale",className:"mt-1 w-full rounded-lg border border-slate-200 bg-slate-50 px-3 py-2 text-sm outline-none focus:border-indigo-500 focus:ring-1 focus:ring-indigo-500 dark:border-slate-800 dark:bg-slate-800 dark:text-white"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300",children:"Description"}),(0,t.jsx)("input",{name:"description",type:"text",placeholder:"Brief description of the campaign...",className:"mt-1 w-full rounded-lg border border-slate-200 bg-slate-50 px-3 py-2 text-sm outline-none focus:border-indigo-500 focus:ring-1 focus:ring-indigo-500 dark:border-slate-800 dark:bg-slate-800 dark:text-white"})]}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300",children:"Start Date"}),(0,t.jsx)("input",{name:"startDate",type:"date",required:!0,defaultValue:new Date().toISOString().split("T")[0],className:"mt-1 w-full rounded-lg border border-slate-200 bg-slate-50 px-3 py-2 text-sm outline-none focus:border-indigo-500 focus:ring-1 focus:ring-indigo-500 dark:border-slate-800 dark:bg-slate-800 dark:text-white"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300",children:"End Date"}),(0,t.jsx)("input",{name:"endDate",type:"date",required:!0,className:"mt-1 w-full rounded-lg border border-slate-200 bg-slate-50 px-3 py-2 text-sm outline-none focus:border-indigo-500 focus:ring-1 focus:ring-indigo-500 dark:border-slate-800 dark:bg-slate-800 dark:text-white"})]})]})]}),(0,t.jsxs)("div",{className:"mt-8 flex gap-3",children:[(0,t.jsx)("button",{type:"submit",className:"flex-1 rounded-lg bg-indigo-600 py-2.5 text-sm font-medium text-white hover:bg-indigo-700",children:"Create Campaign"}),(0,t.jsx)("button",{type:"button",onClick:()=>ed(!1),className:"flex-1 rounded-lg border border-slate-200 py-2.5 text-sm font-medium text-slate-700 hover:bg-slate-50 dark:border-slate-700 dark:text-slate-300 dark:hover:bg-slate-800",children:"Cancel"})]})]})]})})]}):null}e.s(["default",()=>N],37453)}]);