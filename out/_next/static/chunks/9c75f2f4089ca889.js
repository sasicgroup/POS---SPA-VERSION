(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,7233,e=>{"use strict";let t=(0,e.i(75254).default)("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);e.s(["Plus",()=>t],7233)},55436,e=>{"use strict";let t=(0,e.i(75254).default)("search",[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]]);e.s(["Search",()=>t],55436)},27612,e=>{"use strict";let t=(0,e.i(75254).default)("trash-2",[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]]);e.s(["Trash2",()=>t],27612)},31278,e=>{"use strict";let t=(0,e.i(75254).default)("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);e.s(["Loader2",()=>t],31278)},26707,e=>{"use strict";let t=(0,e.i(75254).default)("smartphone",[["rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",key:"1yt0o3"}],["path",{d:"M12 18h.01",key:"mhygvu"}]]);e.s(["Smartphone",()=>t],26707)},92930,e=>{"use strict";let t=(0,e.i(75254).default)("pen",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]]);e.s(["Edit2",()=>t],92930)},51975,e=>{"use strict";let t=(0,e.i(75254).default)("tag",[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]]);e.s(["Tag",()=>t],51975)},67697,e=>{"use strict";var t=e.i(43476),s=e.i(94690),a=e.i(56088),l=e.i(7341),i=e.i(81239),r=e.i(55436),d=e.i(1928),n=e.i(27612),o=e.i(7233),c=e.i(75254);let x=(0,c.default)("minus",[["path",{d:"M5 12h14",key:"1ays0h"}]]),m=(0,c.default)("banknote",[["rect",{width:"20",height:"12",x:"2",y:"6",rx:"2",key:"9lu3g6"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}],["path",{d:"M6 12h.01M18 12h.01",key:"113zkx"}]]);var u=e.i(26707),h=e.i(50627),g=e.i(15338),p=e.i(68553),b=e.i(51975),f=e.i(37727),v=e.i(61911),j=e.i(92930),N=e.i(78894),k=e.i(31278),w=e.i(71645);e.i(22964);var y=e.i(99776),S=e.i(7471);function C(){let{activeStore:e,user:c}=(0,s.useAuth)(),{products:C,isLoading:$,processSale:_}=(0,a.useInventory)(),{showToast:P}=(0,i.useToast)(),[T,F]=(0,w.useState)([]);(0,w.useEffect)(()=>{e?.id&&(0,l.loadSMSConfigFromDB)(e.id)},[e]),(0,w.useEffect)(()=>{let e=localStorage.getItem("sms_cart");if(e)try{F(JSON.parse(e))}catch(e){console.error("Failed to parse cart",e)}},[]),(0,w.useEffect)(()=>{try{let e=T.map(e=>({...e,image:e.image&&e.image.length>500?void 0:e.image,video:void 0,description:void 0,status:void 0}));localStorage.setItem("sms_cart",JSON.stringify(e))}catch(e){console.error("Failed to save cart to local storage:",e),("QuotaExceededError"===e.name||e.message.toLowerCase().includes("quota"))&&P("error","Storage usage high. Cart may not persist on reload.")}},[T]);let[q,M]=(0,w.useState)(""),[A,z]=(0,w.useState)(!1),[L,E]=(0,w.useState)(null),H=(0,w.useRef)(null),[G,R]=(0,w.useState)(null),[I,O]=(0,w.useState)(""),[D,B]=(0,w.useState)(""),[U,X]=(0,w.useState)(""),[K,V]=(0,w.useState)(0),[J,Q]=(0,w.useState)(!1),[W,Y]=(0,w.useState)(null),[Z,ee]=(0,w.useState)(!1);(0,w.useEffect)(()=>{let t=setTimeout(async()=>{if(!e?.id||U.length<10){Y(null),V(0),W&&B("");return}ee(!0);let{data:t}=await S.supabase.from("customers").select("*").eq("store_id",e.id).eq("phone",U).single();t?(Y(t),B(t.name),V(t.points||0)):(Y(null),B(""),V(0)),ee(!1)},500);return()=>clearTimeout(t)},[U,e]);let[et,es]=(0,w.useState)(!1),[ea,el]=(0,w.useState)(!1),[ei,er]=(0,w.useState)(null),[ed,en]=(0,w.useState)(!1),[eo,ec]=(0,w.useState)(""),ex=(0,w.useRef)(null),[em,eu]=(0,w.useState)("Main-01"),[eh,eg]=(0,w.useState)(null);if((0,w.useEffect)(()=>{let t=localStorage.getItem("sms_register_id");t&&eu(t),(async()=>{if(!e?.id)return;let{data:t}=await S.supabase.from("loyalty_programs").select("*").eq("store_id",e.id).single();t&&eg(t)})()},[e]),(0,w.useEffect)(()=>(A?(ec(""),setTimeout(()=>{if(ex.current)try{ex.current.clear()}catch(e){console.error("Clear error",e)}if(document.getElementById("sales-scanner-reader"))try{let e=new y.Html5Qrcode("sales-scanner-reader");ex.current=e,e.start({facingMode:"environment"},{fps:10,qrbox:{width:250,height:250},aspectRatio:1},async(e,t)=>{if(ex.current&&ex.current.isScanning)try{await ex.current.stop(),ex.current.clear()}catch(e){console.error("Stop error",e)}eN(e),z(!1)},e=>{}).catch(e=>{console.error("Camera start error:",e),ec("Unable to access camera. Please check permissions.")})}catch(e){console.error("Scanner init error",e),ec("Failed to initialize scanner.")}},300)):ex.current&&(ex.current.isScanning&&ex.current.stop().catch(e=>console.error(e)),ex.current.clear(),ex.current=null),()=>{ex.current&&(ex.current.isScanning&&ex.current.stop().catch(e=>console.error(e)),ex.current.clear())}),[A]),!e)return null;let ep="undefined"!=typeof Audio?new Audio("https://assets.mixkit.co/active_storage/sfx/2578/2578-preview.mp3"):null,eb="undefined"!=typeof Audio?new Audio("https://assets.mixkit.co/active_storage/sfx/2572/2572-preview.mp3"):null,ef="undefined"!=typeof Audio?new Audio("https://assets.mixkit.co/active_storage/sfx/2013/2013-preview.mp3"):null,ev=e=>{if(e.stock<=0){ej(),P("error","This item is out of stock!");return}ep&&(ep.currentTime=0,ep.play().catch(e=>console.error("Audio play failed",e))),F(t=>{let s=t.find(t=>t.id===e.id);return s?s.quantity>=e.stock?(P("error","Cannot add more than available stock!"),t):t.map(t=>t.id===e.id?{...t,quantity:t.quantity+1}:t):[...t,{...e,quantity:1}]})},ej=()=>{eb&&(eb.currentTime=0,eb.play().catch(e=>console.error("Audio play failed",e)))},eN=e=>{if(!e)return;let t=C.find(t=>{let s=t.sku?t.sku.toLowerCase().trim():"",a=t.name?t.name.toLowerCase():"",l=e.toLowerCase().trim();return s===l||a&&a.includes(l)||s&&s.includes(l)});t?(ev(t),M("")):(ej(),P("error","Product not found"))},ek=T.reduce((e,t)=>e+t.price*t.quantity,0),ew=e.taxSettings||{enabled:!0,type:"percentage",value:8},ey=ew.enabled?"percentage"===ew.type?ek*(ew.value/100):ew.value:0,eS=eh?.min_points_to_redeem||100,eC=eS*(eh?.redemption_rate||.05),e$=ek+ey-(J?eC:0),e_=async()=>{let t=(e.lastTransactionNumber||0)+1,s=e.receiptPrefix||"TRX",a=e.receiptSuffix||"",i=t.toString().padStart(5,"0"),r=`${s}-${i}${a}`,d=await _({items:T.map(e=>({id:e.id,quantity:e.quantity,price:e.price})),totalAmount:e$,paymentMethod:ei,customer:D||U?{name:D,phone:U}:void 0});if(!d)return void P("error","Failed to process sale. Please try again.");await S.supabase.from("stores").update({last_transaction_number:t}).eq("id",e.id),await S.supabase.from("notifications").insert({store_id:e.id,type:"order",title:`New Order #${r}`,message:`${D||"A customer"} placed a new order for GHS ${e$.toFixed(2)}.`,metadata:{sale_id:d,transaction_id:r,amount:e$,customer:D||"Guest"}});let n=eh?.enabled?Math.floor(e$*(eh.points_per_currency||1)):0;if(U){let{data:t}=await S.supabase.from("customers").select("*").eq("store_id",e.id).eq("phone",U).single();if(t){let s=t.points||0,a=J?s-eS+n:s+n;await S.supabase.from("customers").update({points:a,total_spent:(t.total_spent||0)+e$,total_visits:(t.total_visits||0)+1,last_visit:new Date().toISOString()}).eq("id",t.id),V(a),Y({...t,points:a,total_spent:(t.total_spent||0)+e$,total_visits:(t.total_visits||0)+1}),Q(!1),W||await (0,l.sendNotification)("welcome",{customerName:t.name,customerPhone:U}),await (0,l.sendNotification)("sale",{id:r,amount:e$,customerPhone:U,items:T.length,pointsEarned:n,totalPoints:a,staffName:c?.name,storeId:e.id})}else console.warn("Customer not found for points update after sale processing",U)}console.log(`Processing Sale: ${r}`),(t=>{let s=window.open("","_blank","width=400,height=600");if(!s)return;let a=`
            <html>
            <head>
                <title>Receipt ${t}</title>
                <style>
                    body { font-family: 'Courier New', Courier, monospace; font-size: 12px; margin: 0; padding: 20px; }
                    .header { text-align: center; margin-bottom: 20px; }
                    .store-name { font-size: 16px; font-weight: bold; }
                    .divider { border-top: 1px dashed #000; margin: 10px 0; }
                    .item { display: flex; justify-content: space-between; margin-bottom: 5px; }
                    .total { display: flex; justify-content: space-between; font-weight: bold; margin-top: 10px; }
                    .barcode { text-align: center; margin-top: 20px; }
                </style>
            </head>
            <body>
                <div class="header">
                    <div class="store-name">${e.name}</div>
                    <div>Receipt #${t}</div>
                    <div>${new Date().toLocaleString()}</div>
                    ${D?`<div>Customer: ${D}</div>`:""}
                    <div>Sold By: ${c?.name||"Staff"}</div>
                </div>
                <div class="divider"></div>
                ${T.map(e=>`
                    <div class="item">
                        <span>${e.name} x${e.quantity}</span>
                        <span>${(e.price*e.quantity).toFixed(2)}</span>
                    </div>
                `).join("")}
                <div class="divider"></div>
                <div class="item">
                    <span>Subtotal</span>
                    <span>${ek.toFixed(2)}</span>
                </div>
                <div class="item">
                    <span>Tax (${"percentage"===ew.type?ew.value+"%":"Fixed"})</span>
                    <span>${ey.toFixed(2)}</span>
                </div>
                ${J?`
                <div class="item">
                    <span>Loyalty Discount</span>
                    <span>-${eC.toFixed(2)}</span>
                </div>`:""}
                <div class="total">
                    <span>TOTAL</span>
                    <span>${e$.toFixed(2)}</span>
                </div>
                ${D&&eh?.enabled?`<div style="text-align: center; margin-top: 10px;">Points Earned: ${Math.floor(e$*(eh.points_per_currency||1))}</div>`:""}
                <div class="barcode">
                    *${t}*
                </div>
            </body>
            </html>
        `;s.document.write(a),s.document.close(),setTimeout(()=>{s.focus(),s.print(),s.close()},500)})(r),ef&&(ef.currentTime=0,ef.play().catch(e=>console.error("Audio play failed",e))),es(!0),setTimeout(()=>{F([]),localStorage.removeItem("sms_cart"),B(""),X(""),V(0),Q(!1),es(!1)},3e3)},eP=C.filter(e=>e.name.toLowerCase().includes(q.toLowerCase())||e.category.toLowerCase().includes(q.toLowerCase())||e.sku.toLowerCase().includes(q.toLowerCase()));return(0,t.jsxs)("div",{className:"h-[calc(100vh-4rem)] lg:h-[calc(100vh-6rem)] animate-in fade-in slide-in-from-bottom-4 duration-500 relative flex flex-col lg:flex-row gap-4 lg:gap-6",children:[A&&(0,t.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/80 backdrop-blur-sm animate-in fade-in duration-200",children:(0,t.jsxs)("div",{className:"w-full h-full lg:h-auto lg:max-w-2xl rounded-none lg:rounded-2xl bg-white p-6 shadow-2xl dark:bg-slate-900 flex flex-col",children:[(0,t.jsxs)("div",{className:"mb-4 flex items-center justify-between flex-shrink-0",children:[(0,t.jsxs)("h2",{className:"text-xl font-bold text-slate-900 dark:text-white flex items-center gap-2",children:[(0,t.jsx)(p.Camera,{className:"h-6 w-6 text-indigo-600"})," Scanner Active"]}),(0,t.jsx)("button",{onClick:()=>z(!1),className:"rounded-full p-2 hover:bg-slate-100 dark:hover:bg-slate-800",children:(0,t.jsx)(f.X,{className:"h-6 w-6 text-slate-500"})})]}),(0,t.jsx)("div",{className:"flex-1 min-h-0 flex items-center justify-center relative bg-slate-950 rounded-xl overflow-hidden mb-6",children:(0,t.jsx)("div",{id:"sales-scanner-reader",className:"w-full h-full"})}),(0,t.jsx)("div",{className:"p-4 rounded-xl border border-slate-200 dark:border-slate-800 bg-indigo-50 dark:bg-indigo-900/20",children:(0,t.jsx)("p",{className:"text-sm text-center text-indigo-700 dark:text-indigo-400 font-medium",children:"ðŸ“¦ Scan to add items to cart"})})]})}),L&&(0,t.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 backdrop-blur-sm animate-in fade-in zoom-in-95 duration-200 p-4",children:(0,t.jsxs)("div",{className:"w-full max-w-sm rounded-2xl bg-white p-6 shadow-xl dark:bg-slate-900",children:[(0,t.jsxs)("div",{className:"flex justify-between items-start mb-4",children:[(0,t.jsx)("h3",{className:"text-lg font-bold text-slate-900 dark:text-white",children:"Product Scanned"}),(0,t.jsx)("button",{onClick:()=>E(null),className:"text-slate-400 hover:text-slate-600",children:(0,t.jsx)(f.X,{className:"h-5 w-5"})})]}),(0,t.jsx)("img",{src:L.image,className:"w-32 h-32 rounded-xl mx-auto mb-4 bg-slate-100 object-cover"}),(0,t.jsxs)("div",{className:"text-center space-y-2",children:[(0,t.jsx)("h4",{className:"font-semibold text-slate-900 dark:text-slate-100",children:L.name}),(0,t.jsx)("p",{className:"text-sm text-slate-500",children:L.sku}),(0,t.jsxs)("p",{className:"text-2xl font-bold text-indigo-600",children:["GHS ",L.price.toFixed(2)]})]}),(0,t.jsx)("div",{className:"mt-6",children:(0,t.jsx)("button",{onClick:()=>E(null),className:"w-full rounded-xl bg-slate-100 py-3 font-medium text-slate-700 hover:bg-slate-200 dark:bg-slate-800 dark:text-slate-300",children:"Close"})})]})}),et&&(0,t.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 backdrop-blur-sm animate-in fade-in zoom-in-95 duration-200 p-4",children:(0,t.jsxs)("div",{className:"w-full max-w-sm rounded-2xl bg-white p-8 shadow-2xl dark:bg-slate-900 text-center",children:[(0,t.jsx)("div",{className:"mx-auto flex h-16 w-16 items-center justify-center rounded-full bg-green-100 text-green-600 mb-6",children:(0,t.jsx)(h.Receipt,{className:"h-8 w-8"})}),(0,t.jsx)("h2",{className:"text-2xl font-bold text-slate-900 dark:text-white mb-2",children:"Payment Successful!"}),(0,t.jsx)("p",{className:"text-slate-500 mb-6",children:"Transaction completed successfully."}),(0,t.jsxs)("div",{className:"animate-pulse flex justify-center gap-2",children:[(0,t.jsx)("div",{className:"h-2 w-2 rounded-full bg-indigo-600"}),(0,t.jsx)("div",{className:"h-2 w-2 rounded-full bg-indigo-600 delay-75"}),(0,t.jsx)("div",{className:"h-2 w-2 rounded-full bg-indigo-600 delay-150"})]})]})}),(0,t.jsxs)("div",{className:"flex-1 flex flex-col min-h-0 bg-slate-50 dark:bg-slate-900 lg:pr-2",children:[(0,t.jsxs)("div",{className:"mb-4 flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-xl sm:text-2xl font-bold text-slate-900 dark:text-slate-100",children:"Point of Sale"}),(0,t.jsxs)("p",{className:"text-sm text-slate-500 dark:text-slate-400 flex items-center gap-2",children:["Register:",(0,t.jsxs)("button",{onClick:()=>{let e=prompt("Enter Register/Terminal Name:",em);e&&e.trim()&&(eu(e.trim()),localStorage.setItem("sms_register_id",e.trim()))},className:"font-semibold text-indigo-600 hover:underline flex items-center gap-1",children:[em," ",(0,t.jsx)(j.Edit2,{className:"h-3 w-3"})]})]})]}),(0,t.jsx)("div",{className:"flex gap-2 sm:gap-3"})]}),(0,t.jsx)("div",{className:"mb-4 sm:mb-6 flex gap-3",children:(0,t.jsxs)("div",{className:"relative flex-1",children:[(0,t.jsx)(r.Search,{className:"absolute left-4 top-1/2 h-5 w-5 -translate-y-1/2 text-slate-400"}),(0,t.jsx)("input",{ref:H,type:"text",placeholder:"Search or scan...",value:q,onChange:e=>{M(e.target.value)},onKeyDown:e=>{"Enter"===e.key&&eN(q)},className:"w-full rounded-xl border border-slate-200 bg-white py-3 pl-12 pr-12 text-sm shadow-sm outline-none focus:border-indigo-500 focus:ring-1 focus:ring-indigo-500 dark:border-slate-800 dark:bg-slate-800 dark:text-white"}),(0,t.jsx)("button",{onClick:()=>z(!0),className:"absolute right-3 top-1/2 -translate-y-1/2 p-2 text-slate-400 hover:text-indigo-600",title:"Open Camera Scanner",children:(0,t.jsx)(g.Scan,{className:"h-5 w-5"})})]})}),(0,t.jsx)("div",{className:"flex-1 overflow-y-auto pb-20 lg:pb-0",children:(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsxs)("div",{className:"grid grid-cols-12 gap-2 sm:gap-4 px-2 sm:px-4 text-xs font-medium text-slate-400 uppercase tracking-wider",children:[(0,t.jsx)("div",{className:"col-span-8 sm:col-span-6",children:"Product"}),(0,t.jsx)("div",{className:"hidden sm:block sm:col-span-3",children:"Details / Stock"}),(0,t.jsx)("div",{className:"col-span-3 sm:col-span-2 text-right",children:"Price"}),(0,t.jsx)("div",{className:"col-span-1"})]}),$?Array.from({length:6}).map((e,s)=>(0,t.jsxs)("div",{className:"grid grid-cols-12 gap-2 sm:gap-4 items-center rounded-xl border border-slate-200 bg-white p-2 sm:p-3 shadow-sm dark:border-slate-800 dark:bg-slate-800 animate-pulse",children:[(0,t.jsxs)("div",{className:"col-span-8 sm:col-span-6 flex items-center gap-3 sm:gap-4",children:[(0,t.jsx)("div",{className:"h-10 w-10 sm:h-12 sm:w-12 bg-slate-200 dark:bg-slate-700 rounded-lg"}),(0,t.jsxs)("div",{className:"space-y-2 flex-1",children:[(0,t.jsx)("div",{className:"h-4 w-32 bg-slate-200 dark:bg-slate-700 rounded"}),(0,t.jsx)("div",{className:"h-3 w-20 bg-slate-200 dark:bg-slate-700 rounded"})]})]}),(0,t.jsx)("div",{className:"hidden sm:block sm:col-span-3",children:(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)("div",{className:"h-5 w-24 bg-slate-200 dark:bg-slate-700 rounded-full"}),(0,t.jsx)("div",{className:"h-4 w-16 bg-slate-200 dark:bg-slate-700 rounded"})]})}),(0,t.jsx)("div",{className:"col-span-3 sm:col-span-2 text-right",children:(0,t.jsx)("div",{className:"h-5 w-16 bg-slate-200 dark:bg-slate-700 rounded ml-auto"})}),(0,t.jsx)("div",{className:"col-span-1",children:(0,t.jsx)("div",{className:"h-8 w-8 bg-slate-200 dark:bg-slate-700 rounded-lg ml-auto"})})]},`skeleton-${s}`)):0===eP.length?(0,t.jsxs)("div",{className:"text-center py-12",children:[(0,t.jsx)("p",{className:"text-slate-400 dark:text-slate-500 text-lg",children:"No products found"}),(0,t.jsx)("p",{className:"text-slate-400 dark:text-slate-500 text-sm mt-2",children:"Try adjusting your search"})]}):eP.map(e=>{let s=T.find(t=>t.id===e.id),a=s?s.quantity:0;return(0,t.jsxs)("div",{onClick:()=>{window.innerWidth<1024&&ev(e)},className:`group relative grid grid-cols-12 gap-2 sm:gap-4 items-center rounded-xl border ${a>0?"border-indigo-500 ring-1 ring-indigo-500 bg-indigo-50/10":"border-slate-200 bg-white"} p-2 sm:p-3 shadow-sm transition-all hover:border-indigo-300 hover:shadow-md dark:border-slate-800 dark:bg-slate-800 dark:hover:border-indigo-900 active:scale-[0.99] lg:active:scale-100`,children:[(0,t.jsxs)("div",{className:"col-span-8 sm:col-span-6 flex items-center gap-3 sm:gap-4",children:[(0,t.jsxs)("div",{className:"relative h-10 w-10 sm:h-12 sm:w-12 flex-shrink-0",children:[(0,t.jsx)("img",{src:e.image,alt:e.name,className:"h-full w-full rounded-lg object-cover bg-slate-100"}),a>0&&(0,t.jsx)("div",{className:"absolute -top-2 -right-2 h-5 w-5 rounded-full bg-indigo-600 text-[10px] font-bold text-white flex items-center justify-center shadow-sm sm:hidden border-2 border-white dark:border-slate-800",children:a})]}),(0,t.jsxs)("div",{className:"min-w-0",children:[(0,t.jsx)("h3",{className:"text-sm font-semibold text-slate-900 truncate dark:text-slate-100",children:e.name}),(0,t.jsx)("p",{className:"text-xs text-slate-500",children:e.sku})]})]}),(0,t.jsx)("div",{className:"hidden sm:block sm:col-span-3",children:(0,t.jsxs)("div",{className:"flex flex-col gap-1 items-start",children:[(0,t.jsxs)("span",{className:"inline-flex items-center gap-1 rounded-full bg-slate-100 px-2.5 py-0.5 text-xs font-medium text-slate-600 dark:bg-slate-700 dark:text-slate-300",children:[(0,t.jsx)(b.Tag,{className:"h-3 w-3"}),e.category]}),(0,t.jsxs)("span",{className:`text-xs font-bold ${e.stock>10?"text-emerald-600 dark:text-emerald-400":e.stock>0?"text-amber-600 dark:text-amber-400":"text-rose-600 dark:text-rose-400"}`,children:[e.stock," in stock"]})]})}),(0,t.jsx)("div",{className:"col-span-3 sm:col-span-2 text-right",children:(0,t.jsx)("p",{className:"text-sm font-bold text-indigo-600 dark:text-indigo-400",children:e.price.toFixed(2)})}),(0,t.jsx)("div",{className:"col-span-1 text-right flex justify-end",children:a>0?(0,t.jsx)("div",{className:"h-8 w-8 rounded-full bg-indigo-600 text-white flex items-center justify-center font-bold text-xs shadow-sm animate-in zoom-in",children:a}):(0,t.jsx)("button",{onClick:t=>{t.stopPropagation(),ev(e)},disabled:e.stock<=0,className:`rounded-lg p-2 transition-colors hidden sm:inline-block ${e.stock<=0?"bg-slate-100 text-slate-400 cursor-not-allowed dark:bg-slate-800 dark:text-slate-600":"bg-indigo-50 text-indigo-600 hover:bg-indigo-100 dark:bg-indigo-900/20 dark:hover:bg-indigo-900/40"}`,children:(0,t.jsx)(o.Plus,{className:"h-4 w-4"})})})]},e.id)})]})})]}),(0,t.jsx)("div",{className:`fixed bottom-16 left-0 right-0 p-4 bg-white border-t border-slate-200 lg:hidden z-[60] dark:bg-slate-950 dark:border-slate-800 transition-transform duration-300 ${ed?"translate-y-full":"translate-y-0"}`,children:(0,t.jsxs)("div",{className:"flex gap-4",children:[(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsxs)("p",{className:"text-xs text-slate-500 dark:text-slate-400",children:[T.length," items in cart"]}),(0,t.jsxs)("p",{className:"text-lg font-bold text-slate-900 dark:text-white",children:["GHS ",e$.toFixed(2)]})]}),(0,t.jsxs)("button",{onClick:()=>en(!0),disabled:0===T.length,className:"flex items-center gap-2 px-6 py-2 rounded-xl bg-indigo-600 text-white font-bold shadow-lg shadow-indigo-500/30 disabled:opacity-50 disabled:shadow-none",children:[(0,t.jsx)(d.ShoppingCart,{className:"h-5 w-5"}),"View Cart"]})]})}),(0,t.jsx)("div",{className:`
                fixed inset-0 z-[60] bg-white/50 backdrop-blur-sm lg:hidden
                ${ed?"opacity-100 pointer-events-auto":"opacity-0 pointer-events-none delay-200"}
                transition-opacity duration-300
            `,onClick:()=>en(!1)}),(0,t.jsx)("div",{className:`
                fixed inset-y-0 right-0 z-[70] w-full max-w-md bg-white shadow-2xl transition-transform duration-300 ease-in-out dark:bg-slate-900
                lg:static lg:h-full lg:w-96 lg:bg-transparent lg:shadow-none lg:translate-x-0 lg:z-0
                ${ed?"translate-x-0":"translate-x-full"}
            `,children:(0,t.jsxs)("div",{className:"h-full flex flex-col rounded-none lg:rounded-2xl border-l lg:border border-slate-200 lg:bg-white lg:shadow-xl dark:border-slate-800 dark:lg:bg-slate-900",children:[(0,t.jsxs)("div",{className:"border-b border-slate-200 p-4 dark:border-slate-800 flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("button",{onClick:()=>en(!1),className:"lg:hidden p-2 -ml-2 rounded-full hover:bg-slate-100 dark:hover:bg-slate-800",children:(0,t.jsx)(f.X,{className:"h-5 w-5 text-slate-500"})}),(0,t.jsxs)("h2",{className:"text-lg font-bold text-slate-900 dark:text-slate-100 flex items-center gap-2",children:[(0,t.jsx)(d.ShoppingCart,{className:"h-5 w-5"})," Current Order"]})]}),(0,t.jsxs)("span",{className:"rounded-full bg-indigo-100 px-2 py-0.5 text-xs font-bold text-indigo-600 dark:bg-indigo-900/30 dark:text-indigo-400",children:[T.length," items"]})]}),(0,t.jsx)("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:0===T.length?(0,t.jsxs)("div",{className:"flex h-full flex-col items-center justify-center text-center text-slate-400",children:[(0,t.jsx)(d.ShoppingCart,{className:"mb-4 h-16 w-16 opacity-20"}),(0,t.jsx)("p",{children:"Cart is empty"}),(0,t.jsx)("p",{className:"text-sm",children:"Scan items to add to cart"})]}):T.map(e=>(0,t.jsxs)("div",{className:"flex gap-3 animate-in slide-in-from-right-4 duration-300",children:[(0,t.jsx)("div",{className:"h-16 w-16 flex-shrink-0 overflow-hidden rounded-lg bg-slate-100",children:(0,t.jsx)("img",{src:C.find(t=>t.id===e.id)?.image||e.image||"/placeholder.png",alt:e.name,className:"h-full w-full object-cover"})}),(0,t.jsxs)("div",{className:"flex-1 flex flex-col justify-between",children:[(0,t.jsxs)("div",{className:"flex justify-between items-start",children:[(0,t.jsx)("h4",{className:"text-sm font-medium text-slate-900 line-clamp-2 dark:text-slate-100",children:e.name}),(0,t.jsx)("button",{onClick:()=>{var t;return t=e.id,void F(e=>e.filter(e=>e.id!==t))},className:"text-slate-400 hover:text-red-500 ml-2",children:(0,t.jsx)(n.Trash2,{className:"h-4 w-4"})})]}),(0,t.jsxs)("div",{className:"flex justify-between items-end",children:[(0,t.jsxs)("div",{className:"flex items-center rounded-lg border border-slate-200 bg-slate-50 dark:border-slate-700 dark:bg-slate-800",children:[(0,t.jsx)("button",{onClick:()=>{var t;return t=e.id,void F(e=>e.map(e=>{if(e.id===t){let t=e.quantity+-1;return t>0?{...e,quantity:t}:e}return e}))},className:"p-1 hover:bg-slate-200 dark:hover:bg-slate-700 rounded-l-lg text-slate-600 dark:text-slate-400",children:(0,t.jsx)(x,{className:"h-3 w-3"})}),(0,t.jsx)("input",{type:"number",min:"1",value:e.quantity,onChange:t=>{var s,a;return s=e.id,a=parseInt(t.target.value)||1,void F(e=>e.map(e=>e.id===s?{...e,quantity:Math.max(1,a)}:e))},className:"w-12 text-center text-xs font-medium bg-transparent outline-none dark:text-slate-200 [appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none border-none p-0 focus:ring-0"}),(0,t.jsx)("button",{onClick:()=>ev(e),className:"p-1 hover:bg-slate-200 dark:hover:bg-slate-700 rounded-r-lg text-slate-600 dark:text-slate-400",children:(0,t.jsx)(o.Plus,{className:"h-3 w-3"})})]}),(0,t.jsxs)("div",{className:"flex flex-col items-end",children:[(0,t.jsxs)("button",{onClick:()=>{R({id:e.id,name:e.name,currentPrice:e.price}),O(e.price.toString())},className:"flex items-center gap-1.5 text-sm font-semibold text-slate-900 border-b border-dashed border-slate-300 hover:border-indigo-500 hover:text-indigo-600 dark:text-slate-100 dark:border-slate-600",children:[`GHS ${(e.price*e.quantity).toFixed(2)}`,(0,t.jsx)(j.Edit2,{className:"h-3 w-3 opacity-50"})]}),e.costPrice&&e.price<=e.costPrice&&(0,t.jsxs)("span",{className:"flex items-center gap-1 text-[10px] font-bold text-red-600",children:[(0,t.jsx)(N.AlertTriangle,{className:"h-3 w-3"})," Below Cost"]}),e.costPrice&&e.price>e.costPrice&&e.price<1.05*e.costPrice&&(0,t.jsxs)("span",{className:"flex items-center gap-1 text-[10px] font-bold text-amber-600",children:[(0,t.jsx)(N.AlertTriangle,{className:"h-3 w-3"})," Low Margin"]}),e.price!==C.find(t=>t.id===e.id)?.price&&(0,t.jsx)("span",{className:"text-[10px] text-slate-400 line-through",children:`Std: ${(C.find(t=>t.id===e.id)?.price||0).toFixed(2)}`})]})]})]})]},e.id))}),(0,t.jsxs)("div",{className:"border-t border-slate-200 bg-slate-50 p-4 dark:border-slate-800 dark:bg-slate-900/50 rounded-none lg:rounded-b-2xl",children:[(0,t.jsxs)("div",{className:"mb-4 space-y-3 rounded-lg border border-indigo-100 bg-indigo-50/50 p-3 dark:border-indigo-900/30 dark:bg-indigo-900/20",children:[(0,t.jsx)("div",{className:"flex gap-2",children:(0,t.jsxs)("div",{className:"relative flex-1",children:[(0,t.jsx)(u.Smartphone,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-slate-400"}),(0,t.jsx)("input",{type:"tel",placeholder:"Customer Phone",maxLength:10,className:"h-9 w-full rounded-md border border-slate-300 bg-white pl-9 pr-3 text-sm focus:border-indigo-500 focus:outline-none dark:border-slate-700 dark:bg-slate-800",value:U,onChange:e=>{X(e.target.value.replace(/\D/g,""))}}),Z&&(0,t.jsx)("div",{className:"absolute right-3 top-2.5",children:(0,t.jsx)(k.Loader2,{className:"h-4 w-4 animate-spin text-indigo-600"})})]})}),W&&(0,t.jsxs)("div",{className:"animate-in fade-in slide-in-from-top-2",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center mb-1",children:[(0,t.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,t.jsx)("span",{className:"flex h-5 w-5 items-center justify-center rounded-full bg-indigo-100 text-xs font-bold text-indigo-700",children:D.charAt(0)}),(0,t.jsx)("span",{className:"text-sm font-bold text-slate-900 dark:text-slate-100",children:D})]}),(0,t.jsxs)("span",{className:"text-xs font-bold text-indigo-600 dark:text-indigo-400",children:[K," Points"]})]}),K>=(eh?.min_points_to_redeem||100)&&(0,t.jsxs)("label",{className:"flex items-center gap-2 cursor-pointer mt-2",children:[(0,t.jsx)("input",{type:"checkbox",checked:J,onChange:e=>Q(e.target.checked),className:"h-3 w-3 rounded text-indigo-600 focus:ring-indigo-500"}),(0,t.jsxs)("span",{className:"text-xs text-slate-600 dark:text-slate-400",children:["Redeem ",eh?.min_points_to_redeem||100," pts (Get GHS ",eC.toFixed(2)," off)"]})]})]}),!W&&U.length>=10&&!Z&&(0,t.jsxs)("div",{className:"space-y-2 animate-in fade-in",children:[(0,t.jsxs)("div",{className:"text-xs text-slate-500 flex items-center gap-1",children:[(0,t.jsx)(o.Plus,{className:"h-3 w-3"})," New customer registration"]}),(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)(v.Users,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-slate-400"}),(0,t.jsx)("input",{type:"text",placeholder:"Enter Customer Name",value:D,className:"h-9 w-full rounded-md border border-slate-300 bg-white pl-9 pr-3 text-sm focus:border-indigo-500 focus:outline-none dark:border-slate-700 dark:bg-slate-800",onChange:e=>B(e.target.value)})]})]})]}),(0,t.jsxs)("div",{className:"space-y-2 mb-4",children:[(0,t.jsxs)("div",{className:"flex justify-between text-sm text-slate-600 dark:text-slate-400",children:[(0,t.jsx)("span",{children:"Subtotal"}),(0,t.jsx)("span",{children:`GHS ${ek.toFixed(2)}`})]}),(0,t.jsxs)("div",{className:"flex justify-between text-sm text-slate-600 dark:text-slate-400",children:[(0,t.jsx)("span",{children:"Tax"}),(0,t.jsx)("span",{children:`GHS ${ey.toFixed(2)}`})]}),J&&(0,t.jsxs)("div",{className:"flex justify-between text-sm text-emerald-600 dark:text-emerald-400 font-medium",children:[(0,t.jsx)("span",{children:"Loyalty"}),(0,t.jsxs)("span",{children:["- GHS ",eC.toFixed(2)]})]}),(0,t.jsxs)("div",{className:"flex justify-between text-lg font-bold text-slate-900 dark:text-white pt-2 border-t border-slate-200 dark:border-slate-700",children:[(0,t.jsx)("span",{children:"Total"}),(0,t.jsx)("span",{children:`GHS ${e$.toFixed(2)}`})]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-3 mb-4",children:[(0,t.jsxs)("button",{onClick:()=>er("cash"),className:`flex flex-col items-center justify-center gap-1 rounded-lg border p-3 text-sm font-medium transition-all ${"cash"===ei?"border-indigo-600 bg-indigo-50 text-indigo-700 dark:bg-indigo-900/40 dark:text-indigo-300":"border-slate-200 bg-white text-slate-700 hover:border-indigo-500 hover:text-indigo-600 hover:bg-indigo-50 dark:border-slate-700 dark:bg-slate-800 dark:text-slate-300"}`,children:[(0,t.jsx)(m,{className:`h-6 w-6 ${"cash"===ei?"text-indigo-600 dark:text-indigo-400":""}`})," Cash"]}),(0,t.jsxs)("button",{onClick:()=>er("momo"),className:`flex flex-col items-center justify-center gap-1 rounded-lg border p-3 text-sm font-medium transition-all ${"momo"===ei?"border-indigo-600 bg-indigo-50 text-indigo-700 dark:bg-indigo-900/40 dark:text-indigo-300":"border-slate-200 bg-white text-slate-700 hover:border-indigo-500 hover:text-indigo-600 hover:bg-indigo-50 dark:border-slate-700 dark:bg-slate-800 dark:text-slate-300"}`,children:[(0,t.jsx)(u.Smartphone,{className:`h-6 w-6 ${"momo"===ei?"text-indigo-600 dark:text-indigo-400":""}`})," MoMo"]})]}),(0,t.jsx)("button",{onClick:()=>el(!0),disabled:0===T.length||!ei,className:"w-full rounded-xl bg-indigo-600 py-3.5 text-center font-bold text-white shadow-lg shadow-indigo-500/30 transition-all hover:bg-indigo-700 hover:scale-[1.02] active:scale-[0.98] disabled:cursor-not-allowed disabled:opacity-50 disabled:shadow-none",title:ei?"":"Please select a payment method",children:ei?`Checkout â€¢ GHS ${e$.toFixed(2)}`:"Select Payment Method"})]}),ea&&(0,t.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 backdrop-blur-sm animate-in fade-in zoom-in-95 duration-200 p-4",children:(0,t.jsxs)("div",{className:"w-full max-w-sm rounded-2xl bg-white p-6 shadow-2xl dark:bg-slate-900",children:[(0,t.jsx)("h3",{className:"text-xl font-bold text-slate-900 dark:text-white mb-2",children:"Confirm Order"}),(0,t.jsxs)("p",{className:"text-slate-500 mb-6",children:["Are you sure you want to place this order for ",(0,t.jsxs)("span",{className:"font-bold text-slate-900 dark:text-slate-100",children:["GHS ",e$.toFixed(2)]}),"?"]}),(0,t.jsxs)("div",{className:"flex gap-3",children:[(0,t.jsx)("button",{onClick:()=>el(!1),className:"flex-1 rounded-xl bg-slate-100 py-3 font-medium text-slate-700 hover:bg-slate-200 dark:bg-slate-800 dark:text-slate-300",children:"Cancel"}),(0,t.jsx)("button",{onClick:async()=>{el(!1),e_()},className:"flex-1 rounded-xl bg-indigo-600 py-3 font-bold text-white hover:bg-indigo-700",children:"Confirm"})]})]})})]})}),G&&(0,t.jsx)("div",{className:"fixed inset-0 z-[60] flex items-center justify-center bg-black/50 backdrop-blur-sm animate-in fade-in zoom-in-95 duration-200 p-4",children:(0,t.jsxs)("div",{className:"w-full max-w-sm rounded-2xl bg-white p-6 shadow-2xl dark:bg-slate-900",children:[(0,t.jsx)("h3",{className:"text-lg font-bold text-slate-900 dark:text-white mb-2",children:"Edit Price"}),(0,t.jsxs)("p",{className:"text-sm text-slate-500 mb-4",children:["Set new price for ",(0,t.jsx)("span",{className:"font-semibold",children:G.name})]}),(0,t.jsxs)("div",{className:"relative mb-6",children:[(0,t.jsx)("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-slate-400 font-medium",children:"GHS"}),(0,t.jsx)("input",{type:"number",autoFocus:!0,className:"w-full rounded-lg border border-slate-300 bg-slate-50 py-2.5 pl-12 pr-4 text-lg font-bold outline-none focus:border-indigo-500 focus:ring-1 focus:ring-indigo-500 dark:border-slate-700 dark:bg-slate-800 dark:text-white",value:I,onChange:e=>O(e.target.value)})]}),(0,t.jsxs)("div",{className:"flex gap-3",children:[(0,t.jsx)("button",{onClick:()=>R(null),className:"flex-1 rounded-xl bg-slate-100 py-3 font-medium text-slate-700 hover:bg-slate-200 dark:bg-slate-800 dark:text-slate-300",children:"Cancel"}),(0,t.jsx)("button",{onClick:()=>{let e=parseFloat(I);if(!isNaN(e)&&e>=0){var t;t=G.id,F(s=>s.map(s=>s.id===t?{...s,price:e}:s)),R(null)}},className:"flex-1 rounded-xl bg-indigo-600 py-3 font-bold text-white hover:bg-indigo-700",children:"Update"})]})]})})]})}e.s(["default",()=>C],67697)}]);